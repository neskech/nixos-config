# ==============================================================================
#  NESS'S HYPRLAND CONFIGURATION
#  Fully commented for clarity
# ==============================================================================

# --- MONITOR CONFIGURATION ---
# See https://wiki.hyprland.org/Configuring/Monitors/
# This forces your HDMI monitor to be the main screen at its preferred resolution.
# Syntax: monitor = Name, Resolution, Position, Scale
monitor=HDMI-A-1,preferred,auto,1

# (Optional) If you want to use auto-detection for everything, uncomment this:
# monitor=,preferred,auto,1

# --- WORKSPACE BINDINGS ---
# This forces workspaces 1-10 to ALWAYS stay on the HDMI monitor.
# Even if you unplug it, they won't mess up your laptop screen layout.
workspace=1,monitor:HDMI-A-1
workspace=2,monitor:HDMI-A-1
workspace=3,monitor:HDMI-A-1
workspace=4,monitor:HDMI-A-1
workspace=5,monitor:HDMI-A-1
workspace=6,monitor:HDMI-A-1
workspace=7,monitor:HDMI-A-1
workspace=8,monitor:HDMI-A-1
workspace=9,monitor:HDMI-A-1
workspace=10,monitor:HDMI-A-1


# --- AUTOSTART ---
# Commands that run when you log in.
# 1. Runs your custom fish function 'autostart' (Wallpaper, Waybar, Clipboard, etc.)
exec-once = fish -c autostart


# --- THEME SOURCE ---
# Imports color variables (like $teal, $surface1) from your Macchiato theme file.
source = ~/.config/hypr/macchiato.conf


# --- INPUT DEVICES (Keyboard/Mouse) ---
input {
    kb_layout = us

    # 0 = Click to Focus (Windows/macOS style)
    # 1 = Instant Focus (What you have now - Mouse dominates everything)
    # 2 = "Sticky" Focus (Mouse focus changes, but KEYBOARD stays on last clicked window)
    follow_mouse = 2 

    # Mouse sensitivity (-1.0 to 1.0). 0 is default (raw input).
    sensitivity = 0 
}


# --- ENVIRONMENT VARIABLES ---
# Sets the cursor theme and size for the system
env = HYPRCURSOR_THEME,Catppuccin-Macchiato-Teal
env = HYPRCURSOR_SIZE,24
env = XCURSOR_THEME,Catppuccin-Macchiato-Teal
env = XCURSOR_SIZE,24


# --- GENERAL LOOK & FEEL ---
general {
    # Gaps between windows
    gaps_in = 5
    gaps_out = 10
    
    # Border width in pixels
    border_size = 2
    
    # Border colors (uses variables from the sourced macchiato.conf)
    col.active_border = $teal
    col.inactive_border = $surface1

    # The layout engine to use (dwindle is the spiral/bsp default)
    layout = dwindle
}


# --- DECORATION (Blur, Shadows, Opacity) ---
decoration {
    rounding = 10  # Rounded corners radius

    # Blur effect behind transparent windows
    blur {
        size = 8
        passes = 2 # Higher passes = smoother but more GPU usage
    }

    # Drop shadows
    shadow {
        enabled = true
        range = 15
        render_power = 3
        offset = 0, 0
        color = $teal
        color_inactive = 0xff$baseAlpha
    }
    
    # Window Opacity (0.0 to 1.0)
    active_opacity = 0.7       # Active window is slightly transparent
    inactive_opacity = 0.7     # Inactive windows are also transparent
    fullscreen_opacity = 0.7   # Fullscreen windows keep transparency
}

# --- LAYER RULES ---
# Applies blur to the logout menu so it looks nice
layerrule = blur, logout_dialog


# --- ANIMATIONS ---
animations {
    enabled = yes

    # 'myBezier' defines the speed curve of the animation (Pop/Bounce effect)
    bezier = myBezier, 0.05, 0.9, 0.1, 1.05

    # Assigning animations to events
    animation = windows, 1, 2, myBezier      # Window open/close
    animation = windowsOut, 1, 2, default, popin 80% # Window closing effect
    animation = border, 1, 3, default        # Border color changes
    animation = fade, 1, 2, default          # Fade in/out
    animation = workspaces, 1, 1, default    # Switching workspaces
}


# --- LAYOUT SETTINGS (Dwindle) ---
dwindle {
    pseudotile = yes # Allows 'pseudo' tiling (keeping a window its original size inside a tile)
    preserve_split = yes # Keeps your split direction when removing windows
    smart_split = true
}

master {
    new_status = master
}


# --- MISC SETTINGS ---
misc {
    disable_hyprland_logo = true    # Hides the anime girl background on boot
    disable_splash_rendering = true # Hides the text splash on boot
    # This automatically switches you to the window requesting focus (e.g. Chrome)
    focus_on_activate = true
    background_color = 0x24273a     # Fallback background color
}

binds {
    # Allows you to switch back to the previous workspace by pressing the key again
    workspace_back_and_forth = true
}

# --- WINDOW RULES (Smart App Behavior) ---
# Syntax: windowrule = RULE, REGEX_MATCH

# Video Players (mpv): Float, Opaque (No transparency), Fixed Size
windowrule = float, title:.*mpv$
windowrule = opaque, title:.*mpv$
windowrule = size 50% 50%, title:.*mpv$

# Browser Video: If content is video, float and remove transparency
windowrule = float, content:video
windowrule = opaque, content:video
windowrule = size 50% 50%, content:video

# Image Viewers (imv): Float, Opaque, Fixed Size
windowrule = float, title:.*imv.*
windowrule = opaque, title:.*imv.*
windowrule = size 70% 70%, title:.*imv.*

# PDFs: Maximize automatically and remove transparency (so text is readable)
windowrule = float, title:.*\.pdf$
windowrule = opaque, title:.*\.pdf$
windowrule = maximize, title:.*\.pdf$

# YouTube in Chrome: Remove transparency so video isn't see-through
windowrule = opaque, title:.*YouTube - Google Chrome$

# Swappy (Screenshot tool): Center it and keep focus
windowrule = opaque, title:swappy
windowrule = center 1, title:swappy
windowrule = stayfocused, title:swappy


# ==============================================================================
#  KEYBINDINGS
# ==============================================================================

# Sets the "Super" (Windows) key as the main modifier
$mainMod = SUPER

# --- SCRATCHPADS (Pyprland) ---
# Super+Shift+T: Drop-down Terminal
bind = $mainMod SHIFT, T, exec, pypr toggle term
$dropterm  = class:^(kitty-dropterm)$
windowrule = float, $dropterm
windowrule = workspace special:scratch_term, $dropterm
windowrule = size 75% 60%, $dropterm

# Super+Ctrl+V: Drop-down Volume Control
# Simplest approach: Target the class directly to avoid title mismatches
windowrule = float, ^(org.pulseaudio.pavucontrol)$
# The keybind to trigger the Pyprland toggle
bind = $mainMod CTRL, V, exec, pypr toggle volume

# Super+O: Expose (Show all windows like macOS Mission Control)
bind = $mainMod, O, exec, pypr expose
# Super+Z: Zoom feature
bind = $mainMod, Z, exec, pypr zoom


# --- APP LAUNCHERS ---
# Super+T: Terminal (Kitty)
bind = $mainMod, T, exec, kitty

# Super+B: Chrome
bind = $mainMod, B, exec, google-chrome-stable
# Super+F: File Manager (Thunar)
bind = $mainMod, F, exec, thunar
# Super+S: Spotify
bind = $mainMod, S, exec, spotify
# Super+Y: YouTube Music
bind = $mainMod, Y, exec, youtube-music
# Super: App Launcher (Rofi). Kill it if already running
bindr = $mainMod, $mainMod_L, exec, pkill rofi || rofi -show drun
# Super+D: Discordge
bind = $mainMod, D, exec, discord


# --- SYSTEM ACTIONS ---
# Super+Esc: Logout Menu
bind = $mainMod, ESCAPE, exec, fish -c wlogout_uniqe

# --- SCREENSHOT & RECORDING ---
bind = , Print, exec, fish -c screenshot_to_clipboard # Region Screenshot
# bind = $mainMod, E, exec, fish -c screenshot_edit             # Screenshot & Edit
# bind = $mainMod, R, exec, fish -c record_screen_mp4           # Record Video

# --- CLIPBOARD ---
# bind = $mainMod, V, exec, fish -c clipboard_to_type       # Type selected history item
# bind = $mainMod SHIFT, V, exec, fish -c clipboard_to_wlcopy # Copy history item to clipboard
# bind = $mainMod, X, exec, fish -c clipboard_delete_item   # Delete item from history
# bind = $mainMod SHIFT, X, exec, fish -c clipboard_clear   # Clear all history

# --- BOOKMARKS ---
# bind = $mainMod, U, exec, fish -c bookmark_to_type        # Type saved bookmark
# bind = $mainMod SHIFT, U, exec, fish -c bookmark_add      # Add current selection to bookmarks
# bind = $mainMod CTRL, U, exec, fish -c bookmark_delete    # Delete bookmark

# # --- MISC UTILITIES ---
# bind = $mainMod, C, exec, hyprpicker -a                   # Color Picker (Simple)
# bind = $mainMod SHIFT, C, exec, pypr menu "Color picker"  # Color Picker (Menu)
# bind = $mainMod SHIFT, A, exec, fish -c airplane_mode_toggle
# bind = $mainMod SHIFT, N, exec, dunstctl set-paused toggle # Toggle Notifications (DND)
# bind = $mainMod SHIFT, Y, exec, fish -c bluetootPh_toggle
# bind = $mainMod SHIFT, W, exec, fish -c wifi_toggle


# --- WINDOW MANAGEMENT ---
bind = $mainMod, Q, killactive      # Close active window
bind = $mainMod SHIFT, F, togglefloating  # Toggle Float/Tile
bind = $mainMod CTRL, F, fullscreen, 0         # Toggle Fullscreen
# bind = $mainMod SHIFT, P, pseudo          # Toggle Pseudo-tiling
bind = $mainMod SHIFT, O, togglesplit     # Toggle Split direction
# bind = $mainMod ALT, M, exit              # EXIT HYPRLAND (Logout)


# --- MEDIA KEYS ---
bind = $mainMod, p, exec, playerctl play-pause
bind = $mainMod, bracketright, exec, playerctl next
bind = $mainMod, bracketleft, exec, playerctl previous

# Volume Raise/Lower/Mute with OSD popup
bindl = , XF86AudioRaiseVolume, exec, swayosd-client --output-volume raise
bindl = , XF86AudioLowerVolume, exec, swayosd-client --output-volume lower
bindl = , XF86AudioMute, exec, swayosd-client --output-volume mute-toggle
# Toggle microphone mute and show the SwayOSD popup
bindl = , XF86AudioMicMute, exec, swayosd-client --input-volume mute-toggle

# Brightness Raise/Lower with OSD popup
bindl = , XF86MonBrightnessUp, exec, swayosd-client --brightness raise
bindl = , XF86MonBrightnessDown, exec, swayosd-client --brightness lower



# --- FOCUS MOVEMENT ---
# Move focus with Super + Arrow keys or HJKL
bind = $mainMod, left, movefocus, l
bind = $mainMod, right, movefocus, r
bind = $mainMod, up, movefocus, u
bind = $mainMod, down, movefocus, d
bind = $mainMod, h, movefocus, l
bind = $mainMod, l, movefocus, r
bind = $mainMod, k, movefocus, u
bind = $mainMod, j, movefocus, d
bind = $mainMod, Tab, cyclenext,        # Cycle through windows
bind = $mainMod, Tab, bringactivetotop, # Bring cycled window to front


# --- WORKSPACE SWITCHING ---
# Super + 0-9: Switch workspaces on PRIMARY monitor
bind = $mainMod, 1, workspace, 1
bind = $mainMod, 2, workspace, 2
bind = $mainMod, 3, workspace, 3
bind = $mainMod, 4, workspace, 4
bind = $mainMod, 5, workspace, 5
bind = $mainMod, 6, workspace, 6
bind = $mainMod, 7, workspace, 7
bind = $mainMod, 8, workspace, 8
bind = $mainMod, 9, workspace, 9
bind = $mainMod, 0, workspace, 10

# --- MOVE WINDOW TO WORKSPACE ---
# Super + Shift + 0-9: Move window to workspace 1-10
bind = $mainMod SHIFT, 1, movetoworkspace, 1
bind = $mainMod SHIFT, 2, movetoworkspace, 2
bind = $mainMod SHIFT, 3, movetoworkspace, 3
bind = $mainMod SHIFT, 4, movetoworkspace, 4
bind = $mainMod SHIFT, 5, movetoworkspace, 5
bind = $mainMod SHIFT, 6, movetoworkspace, 6
bind = $mainMod SHIFT, 7, movetoworkspace, 7
bind = $mainMod SHIFT, 8, movetoworkspace, 8
bind = $mainMod SHIFT, 9, movetoworkspace, 9
bind = $mainMod SHIFT, 0, movetoworkspace, 10

# Super + Alt + Shift + 0-9: Move window to workspace 11-20
bind = $mainMod ALT SHIFT, 1, movetoworkspace, 11
bind = $mainMod ALT SHIFT, 2, movetoworkspace, 12
bind = $mainMod ALT SHIFT, 3, movetoworkspace, 13
bind = $mainMod ALT SHIFT, 4, movetoworkspace, 14
bind = $mainMod ALT SHIFT, 5, movetoworkspace, 15
bind = $mainMod ALT SHIFT, 6, movetoworkspace, 16
bind = $mainMod ALT SHIFT, 7, movetoworkspace, 17
bind = $mainMod ALT SHIFT, 8, movetoworkspace, 18
bind = $mainMod ALT SHIFT, 9, movetoworkspace, 19
bind = $mainMod ALT SHIFT, 0, movetoworkspace, 20


# --- MOUSE CONTROLS ---
# Scroll through workspaces with mouse wheel
bind = $mainMod, mouse_down, workspace, e+1
bind = $mainMod, mouse_up, workspace, e-1

# Move/Resize windows by holding Super + Click and dragging
bindm = $mainMod, mouse:272, movewindow   # Left Click Drag
bindm = $mainMod, mouse:273, resizewindow # Right Click Drag